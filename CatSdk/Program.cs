using System.Reflection;
using System.Text;
using CatSdk;
using CatSdk.Crypto;
using CatSdk.CryptoTypes;
using CatSdk.Facade;
using CatSdk.Symbol;
//using CatSdk.Nem;
using CatSdk.Symbol.Factory;
using CatSdk.Symbol;
using CatSdk.Utils;
using PublicKey = CatSdk.Nem.PublicKey;
using Signature = CatSdk.Nem.Signature;
using Hash256 = CatSdk.Symbol.Hash256;
var Facade = new SymbolFacade(Network.TestNet);
//AA0000000000000067F3E60E1198E0D30A4BAE9C9AAFCC22836260CD161B22FEF201A9A19F9DB87BE4FED108E1665CD9F38787C87F3066B0E790F88DAA90C2C2DD0AB44DACB62AB10EED4B70AA1FF889D236FA6D63A3AED04C8F9A25EDA329FE3E82DB57D09F005B0000000001984441E0FEEEEFFEEEEFFEE0711EE7711EE7719841E5B8E40781CF74DABF592817DE48711D778648DEAFB20A000000000000000A000600313233424143
//B00000000000000067F3E60E1198E0D30A4BAE9C9AAFCC22836260CD161B22FEF201A9A19F9DB87BE4FED108E1665CD9F38787C87F3066B0E790F88DAA90C2C2DD0AB44DACB62AB10EED4B70AA1FF889D236FA6D63A3AED04C8F9A25EDA329FE3E82DB57D09F005B0000000001984441E0FEEEEFFEEEEFFEE0711EE7711EE7719841E5B8E40781CF74DABF592817DE48711D778648DEAFB20A000000000000000A000C00333133323333343234313433
/*var payload = "AA0000000000000067F3E60E1198E0D30A4BAE9C9AAFCC22836260CD161B22FEF201A9A19F9DB87BE4FED108E1665CD9F38787C87F3066B0E790F88DAA90C2C2DD0AB44DACB62AB10EED4B70AA1FF889D236FA6D63A3AED04C8F9A25EDA329FE3E82DB57D09F005B0000000001984441E0FEEEEFFEEEEFFEE0711EE7711EE7719841E5B8E40781CF74DABF592817DE48711D778648DEAFB20A000000000000000A000600313233424143";
var descriptor = new Dictionary<string, object>(){
    {"Type", "account_metadata_transaction"},
    {"TargetAddress", "TBA6LOHEA6A465G2X5MSQF66JBYR254GJDPK7MQ"},
    {"ScopedMetadataKey", 10},
    {"ValueSizeDelta", 10},
    {"Value", "313233424143"},
    {"SignerPublicKey", "0eed4b70aa1ff889d236fa6d63a3aed04c8f9a25eda329fe3e82db57d09f005b"},
    {"Signature", "67F3E60E1198E0D30A4BAE9C9AAFCC22836260CD161B22FEF201A9A19F9DB87BE4FED108E1665CD9F38787C87F3066B0E790F88DAA90C2C2DD0AB44DACB62AB1"},
    {"Fee", 18370164183782063840},
    {"Deadline", 8207562320463688160},
};
var tx = Facade.TransactionFactory.Create(descriptor);
*/
//C3000000000000001D8D85E74C7E269B95D96516C9B6BF4AE84371C9E8518D6E3B023B840D9A8A8ADB2D5CE3188C9AF85BD1683B0407FB985D12F007817249F504B1E8B2A8DD615DA28AF1AFEB9D81F96578E02EDC455A09AAF0E284598DE4DB1E31BFC5129D85990000000001985242E0FEEEEFFEEEEFFEE0711EE7711EE771989059321905F681BCF47EA33BBF5E6F8298B5440854FDED3FC8BA10229AB5778D05D9C4B7F56676A88BF9295C185ACFC0F961DB5408CAFE0800003941343933363634
//BF000000000000001D8D85E74C7E269B95D96516C9B6BF4AE84371C9E8518D6E3B023B840D9A8A8ADB2D5CE3188C9AF85BD1683B0407FB985D12F007817249F504B1E8B2A8DD615DA28AF1AFEB9D81F96578E02EDC455A09AAF0E284598DE4DB1E31BFC5129D85990000000001985242E0FEEEEFFEEEEFFEE0711EE7711EE771989059321905F681BCF47EA33BBF5E6F8298B5440854FDED3FC8BA10229AB5778D05D9C4B7F56676A88BF9295C185ACFC0F961DB5408CAFE0400009A493664
/*
var payload = "BF000000000000001D8D85E74C7E269B95D96516C9B6BF4AE84371C9E8518D6E3B023B840D9A8A8ADB2D5CE3188C9AF85BD1683B0407FB985D12F007817249F504B1E8B2A8DD615DA28AF1AFEB9D81F96578E02EDC455A09AAF0E284598DE4DB1E31BFC5129D85990000000001985242E0FEEEEFFEEEEFFEE0711EE7711EE771989059321905F681BCF47EA33BBF5E6F8298B5440854FDED3FC8BA10229AB5778D05D9C4B7F56676A88BF9295C185ACFC0F961DB5408CAFE0400009A493664";
var descriptor = new Dictionary<string, object>(){
    {"Type", "secret_proof_transaction"},
    {"RecipientAddress", "TCIFSMQZAX3IDPHUP2RTXP26N6BJRNKEBBKP33I"},
    {"Secret", "3FC8BA10229AB5778D05D9C4B7F56676A88BF9295C185ACFC0F961DB5408CAFE"},
    {"HashAlgorithm", "SHA3_256"},
    {"Proof", "9A493664"},
    {"SignerPublicKey", "a28af1afeb9d81f96578e02edc455a09aaf0e284598de4db1e31bfc5129d8599"},
    {"Signature", "1D8D85E74C7E269B95D96516C9B6BF4AE84371C9E8518D6E3B023B840D9A8A8ADB2D5CE3188C9AF85BD1683B0407FB985D12F007817249F504B1E8B2A8DD615D"},
    {"Fee", 18370164183782063840},
    {"Deadline", 8207562320463688160},
};
*/
//BA0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000A28AF1AFEB9D81F96578E02EDC455A09AAF0E284598DE4DB1E31BFC5129D859900000000019854410000000000000000E0711EE7711EE77198F96BD2F803DE1EE39AACFC53A246F4F7A46901A5D0A53E0A00010000000000C8B6532DDB16843A40420F000000000000476F6F644C75636B21
//BA0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000A28AF1AFEB9D81F96578E02EDC455A09AAF0E284598DE4DB1E31BFC5129D859900000000019854410000000000000000E0711EE7711EE77198F96BD2F803DE1EE39AACFC53A246F4F7A46901A5D0A53E0A00010000000000C8B6532DDB16843A40420F000000000000476F6F644C75636B21
var payload = "BA0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000A28AF1AFEB9D81F96578E02EDC455A09AAF0E284598DE4DB1E31BFC5129D859900000000019854410000000000000000E0711EE7711EE77198F96BD2F803DE1EE39AACFC53A246F4F7A46901A5D0A53E0A00010000000000C8B6532DDB16843A40420F000000000000476F6F644C75636B21";
var descriptor = new Dictionary<string, object>(){
    {"Type", "transfer_transaction"},
    {"RecipientAddress", "TD4WXUXYAPPB5Y42VT6FHISG6T32I2IBUXIKKPQ"},
    {"Message", Converter.Utf8ToPlainMessage("GoodLuck!")},
    {"Mosaics", new Dictionary<string, object>[]{
            new(){
                {"MosaicId", 0x3A8416DB2D53B6C8},
                {"Amount", 1000000},
            },
    }},
    {"SignerPublicKey", "a28af1afeb9d81f96578e02edc455a09aaf0e284598de4db1e31bfc5129d8599"},
    {"Deadline", 8207562320463688160},
};
var tx = (TransferTransaction)Facade.TransactionFactory.Create(descriptor);
Console.WriteLine(Converter.BytesToHex(tx.Serialize()));
Console.WriteLine(Encoding.UTF8.GetBytes("9A493664")[0]);
//Console.WriteLine(Converter.BytesToHex(tx.Proof));

/*
var descriptor = new Dictionary<string, object>(){
    {"Type", TransactionType.AGGREGATE_BONDED},
    {"Transactions", 
        new[] {
            Facade.TransactionFactory.CreateEmbedded(new Dictionary<string, object>() {
                {"Type", TransactionType.ACCOUNT_ADDRESS_RESTRICTION},
                {"RestrictionFlags",
                    new[] {
                        AccountRestrictionFlags.ADDRESS,
                    }
                },
                {"RestrictionAdditions",
                    new[] {
                        new UnresolvedAddress(Converter.StringToAddress("TBA6LOHEA6A465G2X5MSQF66JBYR254GJDPK7MQ")),
                        new UnresolvedAddress(Converter.StringToAddress("TD2ASJ2LKL5LX66PPZ67PYQN4HIMH5SX7OCZLQI"))
                    }
                },
                {
                    "RestrictionDeletions",
                    new[] {
                        new UnresolvedAddress(Converter.StringToAddress("TCIFSMQZAX3IDPHUP2RTXP26N6BJRNKEBBKP33I"))
                    }
                },
            })
        }
    },
    {"SignerPublicKey", new PublicKey(Converter.HexToBytes("8ea547c12b78537039bc5995d09e02731c17fd886a1379161124ab6323cdc8e8"))},
    {"Signature", new Signature(Converter.HexToBytes("5BA55458518264117F13F8DA691B509FBFA3BAC5A6B127506DCE7B89CB92C692699937AB802C4FA695145697E236BE13869CAA10F88FD4307DCEAC637E4AECF6"))},
    {"Fee", new Amount(18370164183782063840)},
    {"Deadline", new Timestamp(8207562320463688160)},
    {"Cosignatures", 
        new Cosignature[]{
        }
    },
    {"TransactionsHash", new Hash256(Converter.HexToBytes("553D90AFA4B171840BCBA16DB6F82A767C98344D5F6D5F2B0B05A8902D01BD4D"))},
};
*/